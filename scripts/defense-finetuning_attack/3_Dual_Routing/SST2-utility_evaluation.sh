main_path=/media/4/yx/education_safety
cd $main_path

export CUDA_VISIBLE_DEVICES=0,1

poison_ratio_names=(SST2_tuning_p_0.2) #  agnews_tuning_p_0 agnews_tuning_p_0.1 agnews_tuning_p_0.2

for i in ${!poison_ratio_names[@]}; do
    poison_ratio_name=${poison_ratio_names[$i]}

    ## ------------- agnews --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
     python TriShield/gen_model_answer-tri_shield.py \
        --model_name qwen3 \
        --model_path /media/1/public_model/Qwen3-8B \
        --lora_path finetuning/finetuned_models/${poison_ratio_name} \
        --data_paths finetuning/evaluation/utility_evaluation/SST2/SST2_test.jsonl \
        --batch_size 1 \
        --gen_batch_size 64 \
        --data_mode test \
        --data_source SST2 \
        --target_layer_ids 1 26 34 \
        --removal_strength 0.01 \
        --removal_ratio 0.25 \
        --refusal_module_id 14 \
        --classifier_path result/defense-finetuning_attack/Classification_Module/${poison_ratio_name} \
        --refusal_module_delta_param_path TriShield/refusal_module/model/${poison_ratio_name}-qwen3 \
        --output_dir result/defense-finetuning_attack/Tri_Shield/${poison_ratio_name} \
        # --disable_highlighter
done



